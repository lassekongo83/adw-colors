name: Compile SASS

on:
  push:
    paths:
      - '**.scss'

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Install Dart Sass
      run: npm install -g sass

    - name: Compile SASS
      run: |
        # Identify all changed files since the last commit
        CHANGED_FILES=$(git diff --name-only HEAD~1..HEAD | grep '\.scss$')
        
        # Loop through each changed SCSS file and compile it
        for FILE in $CHANGED_FILES; do
          echo "Compiling $FILE..."
          sass --style=expanded --no-source-map "$FILE" "${FILE%.*}.css"
        done

    - name: Add, commit, and push
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "<>"
        git add -A
        git commit -m "Compile updated scss to css"
        git push
